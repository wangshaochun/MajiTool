# VS Code REST Client sample requests for MajiTool Blog APIs
# NOTE: Adjust the port to match your Next.js dev server output (3000/3001/etc.)

@base = http://localhost:3000
@token = maji-tool-com
@slug = hello-world-{{$timestamp}}

### Create a post (header: x-api-token)
POST {{base}}/api/blog/posts
Content-Type: application/json
x-api-token: {{token}}

{
  "slug": "{{slug}}",
  "title": "Hello World {{$timestamp}}",
  "excerpt": "Sample created via REST Client",
  "content_md": "# Hello\n\nThis is a test created by REST Client."
}

### Get the post by slug (public)
GET {{base}}/api/blog/posts/{{slug}}

### Update the post (header: Authorization Bearer)
PATCH {{base}}/api/blog/posts/{{slug}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "Hello World (updated) {{$timestamp}}",
  "excerpt": "Updated excerpt via REST Client"
}

### Delete the post (header: x-api-token)
DELETE {{base}}/api/blog/posts/{{slug}}
x-api-token: {{token}}

### --- Optional: Negative cases ---

# 401 Unauthorized (missing token)
POST {{base}}/api/blog/posts
Content-Type: application/json

{
  "slug": "no-token-{{$timestamp}}",
  "title": "Should be 401",
  "content_md": "# Missing token"
}

# 409 Duplicate slug
@slug2 = duplicate-slug-{{$timestamp}}

# First create should succeed
POST {{base}}/api/blog/posts
Content-Type: application/json
x-api-token: {{token}}

{
  "slug": "{{slug2}}",
  "title": "Duplicate test",
  "content_md": "# Duplicate test"
}

# Second create with same slug should return 409
POST {{base}}/api/blog/posts
Content-Type: application/json
x-api-token: {{token}}

{
  "slug": "{{slug2}}",
  "title": "Duplicate test (again)",
  "content_md": "# Duplicate test again"
}